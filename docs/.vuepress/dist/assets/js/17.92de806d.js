(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{341:function(n,s,t){n.exports=t.p+"assets/img/event_task.9a8bf640.png"},342:function(n,s,t){n.exports=t.p+"assets/img/macrotask&microtask.854e9333.png"},434:function(n,s,t){"use strict";t.r(s);var o=t(5),a=Object(o.a)({},(function(){var n=this,s=n.$createElement,o=n._self._c||s;return o("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[o("h1",{attrs:{id:"宏任务和微任务"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#宏任务和微任务","aria-hidden":"true"}},[n._v("#")]),n._v(" 宏任务和微任务")]),n._v(" "),o("p",[n._v("宿主环境提供的叫宏任务（"),o("code",[n._v("macrotask")]),n._v("），由语言标准提供的叫微任务（"),o("code",[n._v("microtask")]),n._v("）。")]),n._v(" "),o("p",[o("strong",[n._v("宿主环境：")])]),n._v(" "),o("p",[n._v("简单来说就是能使 JavaScript 完美运行的环境，只要能完美运行 JavaScript 的载体就是 JavaScript 的宿主环境。目前我们常见的两种宿主环境有浏览器和 node。")]),n._v(" "),o("p",[n._v("宿主环境内所有的内建或自定义的变量/函数都是 "),o("code",[n._v("global")]),n._v("/"),o("code",[n._v("window")]),n._v(" 这个全局对象的属性/方法，而由宿主环境提供的也叫宏任务。主要有：")]),n._v(" "),o("ul",[o("li",[n._v("script(主程序代码);")]),n._v(" "),o("li",[n._v("setTimeout;")]),n._v(" "),o("li",[n._v("setInterval;")]),n._v(" "),o("li",[n._v("setImmediate;")]),n._v(" "),o("li",[n._v("I/O 操作")]),n._v(" "),o("li",[n._v("UI 渲染")]),n._v(" "),o("li",[n._v("requestAnimationFrame")])]),n._v(" "),o("p",[o("strong",[n._v("语言标准：")])]),n._v(" "),o("p",[n._v("JavaScript 由 ECMA 制定标准，称之为 ECMAScript,所以由语言标准提供的就是微任务，主要有：")]),n._v(" "),o("ul",[o("li",[n._v("Promise;")]),n._v(" "),o("li",[n._v("MutationObserver;")]),n._v(" "),o("li",[n._v("process.nextTick();")]),n._v(" "),o("li",[n._v("mutation")]),n._v(" "),o("li",[n._v("Object.observe")])]),n._v(" "),o("div",{staticClass:"custom-block warning"},[o("p",{staticClass:"custom-block-title"},[n._v("注意")]),n._v(" "),o("p",[n._v("不同浏览器不同环境对于这两个的概念会有不同，相同的代码在不同浏览器执行会有不同的顺序，在不同浏览器可能也会有不同的顺序。")])]),n._v(" "),o("p",[n._v("在挂起任务时，JS 引擎会将所有任务按照类别分到这两个队列中，首先在 "),o("code",[n._v("macrotask")]),n._v(" 的队列（这个队列也被叫做 "),o("code",[n._v("task queue")]),n._v("）中取出第一个任务，执行完毕后取出 "),o("code",[n._v("microtask")]),n._v(" 队列中的所有任务顺序执行；之后再取 "),o("code",[n._v("macrotask")]),n._v(" 任务，周而复始，直至两个队列的任务都取完。")]),n._v(" "),o("p",[o("img",{attrs:{src:t(341),alt:"事件循环机制"}})]),n._v(" "),o("p",[n._v("事件循环、宏任务、微任务关系如下：")]),n._v(" "),o("p",[o("img",{attrs:{src:t(342),alt:"事件循环、宏任务、微任务的关系"}})]),n._v(" "),o("div",{staticClass:"language-js extra-class"},[o("pre",{pre:!0,attrs:{class:"language-js"}},[o("code",[n._v("document"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("addEventListener")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("\n    "),o("span",{pre:!0,attrs:{class:"token string"}},[n._v("'click'")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=>")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        Promise"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("resolve")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("then")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=>")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            console"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("log")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("1")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        "),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("setTimeout")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=>")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            console"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("log")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("2")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("0")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        console"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("log")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("3")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n    "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    "),o("span",{pre:!0,attrs:{class:"token boolean"}},[n._v("false")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\ndocument"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("addEventListener")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("\n    "),o("span",{pre:!0,attrs:{class:"token string"}},[n._v("'click'")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=>")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        Promise"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("resolve")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("then")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=>")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            console"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("log")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("4")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        "),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("setTimeout")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=>")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            console"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("log")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("5")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("0")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        console"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("log")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("6")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n    "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    "),o("span",{pre:!0,attrs:{class:"token boolean"}},[n._v("false")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\ndocument"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("addEventListener")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("\n    "),o("span",{pre:!0,attrs:{class:"token string"}},[n._v("'click'")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=>")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        "),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("setTimeout")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=>")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            console"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("log")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("7")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("0")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        Promise"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("resolve")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("then")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=>")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            console"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("log")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("8")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        console"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("log")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("9")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n    "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    "),o("span",{pre:!0,attrs:{class:"token boolean"}},[n._v("false")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\ndocument"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("addEventListener")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("\n    "),o("span",{pre:!0,attrs:{class:"token string"}},[n._v("'click'")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=>")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        "),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("setTimeout")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=>")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            console"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("log")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("10")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("0")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        Promise"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("resolve")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("then")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=>")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            "),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("setTimeout")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=>")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n                console"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("log")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("11")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n            "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v(" "),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("0")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        console"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("log")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token number"}},[n._v("12")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n    "),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n    "),o("span",{pre:!0,attrs:{class:"token boolean"}},[n._v("false")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(",")]),n._v("\n"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\ndocument"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("body"),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),o("span",{pre:!0,attrs:{class:"token function"}},[n._v("click")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),o("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n")])])]),o("p",[n._v("分析：")]),n._v(" "),o("h3",{attrs:{id:"用户手动点击"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#用户手动点击","aria-hidden":"true"}},[n._v("#")]),n._v(" 用户手动点击")]),n._v(" "),o("p",[n._v("当用户手动点击页面时， 响应的是用户行为，事件触发是异步调用模式，所以四个监听事件全部是异步执行：")]),n._v(" "),o("ol",[o("li",[n._v("js 依次将四个异步宏任务入队")])]),n._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[n._v("主线程：''\n异步宏任务队列：[click1, click2, click3, click4]\n异步微任务队列：[]\n")])])]),o("ol",{attrs:{start:"2"}},[o("li",[n._v("此时主线程为空，取出第一个异步宏任务执行；")])]),n._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[n._v("主线程：click1 ->\n异步宏任务队列：[click2, click3, click4]\n异步微任务队列：[]\n")])])]),o("ol",{attrs:{start:"3"}},[o("li",[n._v("Promise.resolve()为同步，执行完后 then 为异步微任务，放入异步微任务队列中;")])]),n._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[n._v("主线程：click1 -> Promise\n异步宏任务队列：[click2, click3, click4]\n异步微任务队列：[console.log(1)]\n")])])]),o("ol",{attrs:{start:"4"}},[o("li",[n._v("setTimeout 为异步宏任务，放入异步宏任务队列中；")])]),n._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[n._v("主线程：click1 -> setTimeout\n异步宏任务队列：[click2, click3, click4, console.log(2)]\n异步微任务队列：[console.log(1)]\n")])])]),o("ol",{attrs:{start:"5"}},[o("li",[n._v("console.log(3)为同步任务，直接执行，"),o("strong",[n._v("输出 3")]),n._v(";")])]),n._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[n._v("主线程：click1 ->console.log(3)\n异步宏任务队列：[click2, click3, click4, console.log(2)]\n异步微任务队列：[console.log(1)]\n")])])]),o("ol",{attrs:{start:"6"}},[o("li",[n._v("由于执行完该任务下的所有微任务才能继续执行下一个宏任务，所以将异步微任务中的 console.log(1)取出执行，"),o("strong",[n._v("输出 1")]),n._v("。")])]),n._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[n._v("主线程：click1 -> console.log(1)\n异步宏任务队列：[click2, click3, click4, console.log(2)]\n异步微任务队列：[]\n")])])]),o("ol",{attrs:{start:"7"}},[o("li",[n._v("该宏异步任务执行完毕，执行下一个宏任务。取出 click2;")])]),n._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[n._v("主线程：click2 -> Promise\n异步宏任务队列：[click3, click4, console.log(2)]\n异步微任务队列：[]\n")])])]),o("p",[n._v("接下执行顺序同理，所以主线程、宏任务异步队列与微任务异步队列依次为：")]),n._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[n._v("主线程：''\n异步宏任务队列：[]\n异步微任务队列：[]\n\n主线程：''\n异步宏任务队列：[click1]\n异步微任务队列：[]\n\n主线程：''\n异步宏任务队列：[click1, click2]\n异步微任务队列：[]\n\n主线程：''\n异步宏任务队列：[click1, click2, click3]\n异步微任务队列：[]\n\n主线程：''\n异步宏任务队列：[click1, click2, click3, click4]\n异步微任务队列：[]\n\n主线程：click1 -> Promise\n异步宏任务队列：[click2, click3, click4]\n异步微任务队列：[console.log(1)]\n\n主线程：click1 -> setTimeout\n异步宏任务队列：[click2, click3, click4, console.log(2)]\n异步微任务队列：[console.log(1)]\n\n主线程：click1 -> console.log(3)\n异步宏任务队列：[click2, click3, click4, console.log(2)]\n异步微任务队列：[console.log(1)]\n\n主线程：click1 -> console.log(1)\n异步宏任务队列：[click2, click3, click4, console.log(2)]\n异步微任务队列：[]\n\n主线程：click2 -> Promise\n异步宏任务队列：[click3, click4, console.log(2)]\n异步微任务队列：[console.log(4)]\n\n主线程：click2 -> setTimeout\n异步宏任务队列：[click3, click4, console.log(2), conosl.elog(5)]\n异步微任务队列：[console.log(4)]\n\n\n主线程：click2 -> console.log(6)\n异步宏任务队列：[click3, click4, console.log(2), conosl.elog(5)]\n异步微任务队列：[console.log(4)]\n\n主线程：click2 -> console.log(4)\n异步宏任务队列：[click3, click4, console.log(2), conosl.elog(5)]\n异步微任务队列：[]\n\n主线程：click3 -> setTimeout\n异步宏任务队列：[click4, console.log(2), conosl.elog(5), console.log(7)]\n异步微任务队列：[]\n\n主线程：click3 -> Promise\n异步宏任务队列：[click4, console.log(2), conosl.elog(5), console.log(7)]\n异步微任务队列：[console.log(8)]\n\n主线程：click3 -> console.log(9)\n异步宏任务队列：[click4, console.log(2), conosl.elog(5), console.log(7)]\n异步微任务队列：[console.log(8)]\n\n主线程：click3 -> console.log(8)\n异步宏任务队列：[click4, console.log(2), conosl.elog(5), console.log(7)]\n异步微任务队列：[]\n\n主线程：click4 -> setTimeout\n异步宏任务队列：[console.log(2), conosl.elog(5), console.log(7), console.log(10)]\n异步微任务队列：[]\n\n主线程：click4 -> Promise\n异步宏任务队列：[console.log(2), conosl.elog(5), console.log(7), console.log(10)]\n异步微任务队列：[setTimeout(() => { console.log(11) }, 0)]\n\n主线程：click4 -> console.log(12)\n异步宏任务队列：[console.log(2), conosl.elog(5), console.log(7), console.log(10)]\n异步微任务队列：[setTimeout(() => { console.log(11) }, 0)]\n\n主线程：click4 -> setTimeout(() => { console.log(11) }, 0)\n异步宏任务队列：[console.log(2), conosl.elog(5), console.log(7), console.log(10), console.log(11)]\n异步微任务队列：[]\n\n主线程：console.log(2)\n异步宏任务队列：[conosl.elog(5), console.log(7), console.log(10), console.log(11)]\n异步微任务队列：[]\n\n主线程：console.log(5)\n异步宏任务队列：[console.log(7), console.log(10), console.log(11)]\n异步微任务队列：[]\n\n主线程：console.log(7)\n异步宏任务队列：[console.log(10), console.log(11)]\n异步微任务队列：[]\n\n主线程：console.log(10)\n异步宏任务队列：[console.log(11)]\n异步微任务队列：[]\n\n主线程：console.log(11)\n异步宏任务队列：[]\n异步微任务队列：[]\n\n主线程：''\n异步宏任务队列：[]\n异步微任务队列：[]\n")])])]),o("p",[n._v("所以输出出来的顺序为： "),o("code",[n._v("3 -> 1 -> 6 -> 4 -> 9 -> 8 -> 12 -> 2 -> 5 -> 7 -> 10 -> 11")]),n._v("。")]),n._v(" "),o("h3",{attrs:{id:"js-触发"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#js-触发","aria-hidden":"true"}},[n._v("#")]),n._v(" JS 触发")]),n._v(" "),o("p",[n._v("JS 触发为同步调用，所以四个监听事件同步执行")]),n._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[n._v("主线程：''\n异步宏任务队列：[]\n异步微任务队列：[]\n\n主线程：''\n异步宏任务队列：[click1 + click2 + click3 + click4]\n异步微任务队列：[]\n\n主线程：click -> Promise\n异步宏任务队列：[]\n异步微任务队列：[console.log(1)]\n\n主线程：click -> setTimeout\n异步宏任务队列：[console.log(2)]\n异步微任务队列：[console.log(1)]\n\n主线程：click -> console.log(3)\n异步宏任务队列：[console.log(2)]\n异步微任务队列：[console.log(1)]\n\n主线程：click -> Promise\n异步宏任务队列：[console.log(2)]\n异步微任务队列：[console.log(1), console.log(4)]\n\n主线程：click -> setTimeout\n异步宏任务队列：[console.log(2), console.log(5)]\n异步微任务队列：[console.log(1), console.log(4)]\n\n主线程：click -> console.log(6)\n异步宏任务队列：[console.log(2), console.log(5)]\n异步微任务队列：[console.log(1), console.log(4)]\n\n主线程：click -> setTimeout\n异步宏任务队列：[console.log(2), console.log(5), console.log(7)]\n异步微任务队列：[console.log(1), console.log(4)]\n\n主线程：click -> Promise\n异步宏任务队列：[console.log(2), console.log(5), console.log(7)]\n异步微任务队列：[console.log(1), console.log(4), console.log(8)]\n\n主线程：click -> console.log(9)\n异步宏任务队列：[console.log(2), console.log(5), console.log(7)]\n异步微任务队列：[console.log(1), console.log(4), console.log(8)]\n\n主线程：click -> setTimeout\n异步宏任务队列：[console.log(2), console.log(5), console.log(7), console.log(10)]\n异步微任务队列：[console.log(1), console.log(4), console.log(8)]\n\n主线程：click -> Promise\n异步宏任务队列：[console.log(2), console.log(5), console.log(7), console.log(10)]\n异步微任务队列：[console.log(1), console.log(4), console.log(8), setTimeout]\n\n主线程：click -> console.log(12)\n异步宏任务队列：[console.log(2), console.log(5), console.log(7), console.log(10)]\n异步微任务队列：[console.log(1), console.log(4), console.log(8), setTimeout]\n\n主线程：click -> console.log(1)\n异步宏任务队列：[console.log(2), console.log(5), console.log(7), console.log(10)]\n异步微任务队列：[console.log(4), console.log(8), setTimeout]\n\n主线程：click -> console.log(4)\n异步宏任务队列：[console.log(2), console.log(5), console.log(7), console.log(10)]\n异步微任务队列：[console.log(8), setTimeout]\n\n主线程：click -> console.log(8)\n异步宏任务队列：[console.log(2), console.log(5), console.log(7), console.log(10)]\n异步微任务队列：[setTimeout]\n\n主线程：click -> setTimeout\n异步宏任务队列：[console.log(2), console.log(5), console.log(7), console.log(10), console.log(11)]\n异步微任务队列：[]\n\n主线程：click -> console.log(2)\n异步宏任务队列：[console.log(5), console.log(7), console.log(10), console.log(11)]\n异步微任务队列：[]\n\n主线程：click -> console.log(5)\n异步宏任务队列：[console.log(7), console.log(10), console.log(11)]\n异步微任务队列：[]\n\n主线程：click -> console.log(7)\n异步宏任务队列：[console.log(10), console.log(11)]\n异步微任务队列：[]\n\n主线程：click -> console.log(10)\n异步宏任务队列：[console.log(11)]\n异步微任务队列：[]\n\n主线程：click -> console.log(11)\n异步宏任务队列：[]\n异步微任务队列：[]\n\n主线程：''\n异步宏任务队列：[]\n异步微任务队列：[]\n")])])]),o("p",[n._v("所以 JS 调用的输出顺序为："),o("code",[n._v("3 -> 6 -> 9 -> 12 -> 1 -> 4 -> 8 -> 2 -> 5 -> 7 -> 10 -> 11")]),n._v("。")])])}),[],!1,null,null,null);s.default=a.exports}}]);